{{- $is_windows := eq .chezmoi.os "windows" -}}
{{- $is_srv :=  eq .chezmoi.hostname "DreSRV" }}
{{- if $is_windows }}
XAuthLocation "C:/Program Files/VcXsrv/xauth.exe"
{{- end }}

Host DreSRV
    HostName {{ .dresrv.local_ip }}

Host DreSRV-agent
    HostName {{ .dresrv.local_ip }}
    User andrei
    ForwardAgent yes
{{- if and (not $is_srv) (not $is_windows) }}
    RemoteForward /run/user/1000/gnupg/S.gpg-agent /run/user/1000/gnupg/S.gpg-agent.extra
{{- end }}

{{- if not $is_srv }}
Host DreSRV-X
    HostName {{ .dresrv.local_ip }}
    ForwardX11 yes
    ForwardX11Trusted yes
{{- if $is_windows }}
    RequestTTY yes
    RemoteCommand export GDK_SCALE=2; export QT_SCREEN_SCALE_FACTORS=2; export QT_AUTO_SCREEN_SCALE_FACTOR=0; export GDK_DPI_SCALE=0.75; zsh
{{- end }}
{{- end }}

Host dresrv.com
{{- if .dresrv.use_domain }}
    HostName {{ .dresrv.domain }}
    Port {{ .dresrv.ssh_port }}
{{- else }}
    HostName {{ .dresrv.local_ip }}
{{- end }}

Host dresrv.com-agent
    HostName dresrv.com
    User andrei
    ForwardAgent yes
{{- if and (not $is_srv) (not $is_windows) }}
    RemoteForward /run/user/1000/gnupg/S.gpg-agent /run/user/1000/gnupg/S.gpg-agent.extra
{{- end }}

Host github.com
    HostName github.com
{{- if not $is_srv }}
    IdentityFile {{ if eq .chezmoi.username "root" }}/home/andrei{{ else }}~{{ end }}/.ssh/id_ed25519.cosandr
{{- else }}
    IdentityFile ~/.ssh/desktop_ed25519.cosandr
    IdentityFile ~/.ssh/laptop_ed25519.cosandr
{{- end }}

Host github.com-atgb
    HostName github.com
{{- if not $is_srv }}
    IdentityFile {{ if eq .chezmoi.username "root" }}/home/andrei{{ else }}~{{ end }}/.ssh/id_ed25519.atgb
{{- else }}
    IdentityFile ~/.ssh/desktop_ed25519.atgb
    IdentityFile ~/.ssh/laptop_ed25519.atgb
{{- end }}

Host srvsim
    HostName 192.168.122.6
    User root
{{- if not $is_srv }}
    ProxyJump DreSRV
{{- end }}

Host srvsim-boot
    HostName 192.168.122.6
    Port 2222
    User root
{{- if not $is_srv }}
    ProxyJump DreSRV
{{- end }}

Host romsto
    HostName {{ .romsto.domain }}
    Port {{ .romsto.ssh_port }}

Host romvm
    HostName 10.1.1.5
    ProxyJump romsto
