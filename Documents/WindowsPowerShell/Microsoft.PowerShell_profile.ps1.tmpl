# Set-ExecutionPolicy -ExecutionPolicy Unrestricted -Scope CurrentUser
# if (!(Test-Path -Path $PROFILE )) { New-Item -Type File -Path $PROFILE -Force }

function git-alt {
    echo "Setting git to atgb"
    git config user.email "{{ .git.public_email }}"
    git config user.name "{{ .git.public_name }}"
}

function git-main {
    echo "Setting git to cosandr"
    git config user.email "{{ .git.private_email }}"
    git config user.name "{{ .git.private_name }}"
}

function ssh-dresrv-x {
    $env:DISPLAY="localhost:0.0"
    ssh DreSRV-X
    Remove-Item env:DISPLAY
}

function pip-req {
    py -3 -m pip install -U pip wheel setuptools
    py -3 -m pip install --use-feature=2020-resolver -U -r requirements.txt
}

$HOSTS = "C:\Windows\System32\drivers\etc\hosts"
$env:EDITOR="vim"

# Aliases (and functions acting as aliases)
{{- range $k, $v := .check.files }}
{{ if ne $v "" }}function logs-{{ $k }} { Get-Content {{ $v }} -Wait -Tail 10 }{{ end }}
{{- end }}

{{- if has "docker" .check.exec }}
function dls { docker container ls -a --format "table {{ "{{.Names}}" }}\t{{ "{{.Status}}" }}\t{{ "{{.RunningFor}}" }}\t" }
function dlog { docker logs -f $args }
function dex { docker exec -t $args }
function dsti { docker container start -i $args }
{{- end }}
function touch ($file) { echo "" >> $file }
function la { Get-ChildItem -Force $args }
function sudoedit { Start-Process -Verb runAs vim $args }
function sudo-wt { Start-Process -Verb runAs wt.exe }
function pip-req-dev { py -3 -m pip install -U -r requirements_dev.txt }
function git-sign { git config commit.gpgsign true }
Set-Alias ll Get-ChildItem
Set-Alias st "C:\Program Files\Sublime Text 3\sublime_text.exe"
Set-Alias which where.exe

Import-Module posh-git
Import-Module oh-my-posh
Set-Theme Avit
# PSReadLine
Import-Module PSReadLine
Set-PSReadLineOption -EditMode Emacs
Set-PSReadlineKeyHandler -Key UpArrow -Function HistorySearchBackward
Set-PSReadlineKeyHandler –Key DownArrow -Function HistorySearchForward

Set-PSReadlineKeyHandler –Key Ctrl+RightArrow -Function ForwardWord
Set-PSReadlineKeyHandler –Key Ctrl+LeftArrow -Function BackwardWord

# Chocolatey profile
$ChocolateyProfile = "$env:ChocolateyInstall\helpers\chocolateyProfile.psm1"
if (Test-Path($ChocolateyProfile)) {
  Import-Module "$ChocolateyProfile"
}
